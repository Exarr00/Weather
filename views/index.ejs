<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../public/css/main.css">
    <title>Weather</title>
</head>

<body>
    <div class="main-container">
        <header>
            <label class="degree-toggle" for="degrees">
                <input type="checkbox" class="degree-input" name="degrees" id="degrees">
                <div class="degree-slider">
                    <p class="input-f">°F</p>
                    <p class="input-c">°C</p>
                </div>
            </label>
            <div class="search-container">
                <form id="search-form">
                    <input type="text" name="city" placeholder="ENTER A CITY">
                </form>
                <div class="error-msg"><p>Not Found!</p></div>
            </div>
        </header>
        <div class="container">
            <div class="main">
                <h1 class="city"><%= weather.name %>,</h1>
                <h2 class="country"><%= country_name %> </h2>
                <h1 class="current-temp"><span data-temp><%= weather.main.temp %></span>°</h1>
                <div class="low-high">
                    <h3 class="max-temp">High: <span data-temp><%= weather.main.temp_max %></span>°</h3>
                    <h3 class="min-temp">Low: <span data-temp><%= weather.main.temp_min %></span>°</h3>
                </div>
                <h3 class="current-time"><%= new Date(weather.dt * 1000).toLocaleTimeString() %> </h3>
            </div>
            <div class="extra-info">
                <div class="extra-info-imgs">
                    <img src="<%= country_flag %>"  alt="" id="flag"/>
                    <img src=<%= `http://openweathermap.org/img/wn/${weather.weather[0].icon}@2x.png` %> id="weather-icon"/>
                </div>
                <div class="extra-info-data">
                    <div id="extra-info-data-first">
                        <h3 class="weather-main">Weather: <span><%= weather.weather[0].main %></span> </h3>
                        <h3 class="feels-like">Feels Like: <span data-temp><%= weather.main.feels_like %></span>°</h3>
                        <h3 class="humidity">Humidity: <span> <%= weather.main.humidity %></span> %</h3>
                        <h3 class="sunrise">Sunrise: <span><%= new Date(weather.sys.sunrise * 1000).toLocaleTimeString() %></span> </h3>
                    </div>
                    <div id="extra-info-data-second">
                        <h3 class="weather-desc">Desc: <span><%= weather.weather[0].description %></span></h3>
                        <h3 class="wind-speed">Wind Speed: <span><%= weather.wind.speed %> </span> mph</h3>
                        <h3 class="pressure" >Pressure: <span><%= weather.main.pressure %></span> hPa</h3>
                        <h3 class="sunset">Sunset: <span> <%= new Date(weather.sys.sunset * 1000).toLocaleTimeString() %></span></h3>
                    </div>
                </div>
            </div>
            <div class="forecast">
                <% forecast.list.forEach(temp=> { %>
                        <% const date = new Date(temp.dt * 1000) %>
                        <div class="day-temp">
                            <p><%= date.toLocaleDateString() %></p>
                            <p><%= date.toLocaleTimeString('en-US', {hour12: false}) %></p>
                            <p><%= date.toLocaleTimeString()%></p>
                            <p data-temp><%= temp.main.temp %></p>
                            <img src=<%= `http://openweathermap.org/img/wn/${temp.weather[0].icon}@2x.png` %> />
                            <p><%= temp.weather[0].main %></p>
                            <p><%= temp.weather[0].description %></p>
                        </div>
                <% }) %>
            </div>
        </div>
  
</body>
<script type="module" src="../public/js/index.js"></script>

<style>
    *,*::before,*::after{
        margin: 0;
        padding:0;
        box-sizing: border-box;
    }
    body{
        height: 100vh;
        width: 100vw;
        max-width: 100%;
        background-image: url("../public/imgs/fog_day.jpg");
        background-attachment: fixed;
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
        color:white;
        text-shadow: 1px 1px 10px black;
        text-transform: uppercase;
    }

    .forecast{
        display: flex;
        overflow-x: scroll;
        width: 82%;
        gap:1rem;
        grid-area: forecast;
    }

    h1{
        font-size: 5rem;
    }

    h2{
        font-size: 3rem;
    }

    .main{
        grid-area: main;
    }

    .country{
        text-align: right;
    }

    .current-temp, .current-time{
        text-align: center;
    }

    .extra-info{
        grid-area: info;
        background-color: rgba(0, 0, 0, 0.5);
        border-radius: 20px;
        padding: 1rem;
    }

    .extra-info-imgs{
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .extra-info-data{
        display: flex;
        flex-direction: row;
        gap: 1rem;
    }

    .day-temp{
        display: flex;
        flex-direction: column;
        place-items: center;
        min-width: 25ch;
        border: 5px solid black;
        padding: 0.5rem;
    }

    .container{
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-template-areas: 
        "main info"
        "forecast forecast";
        place-items: center;
        row-gap: 1.5rem;
    }

    header{
        display: flex;
        justify-content: space-between;
        padding: 1rem;
        align-items: center;
        overflow-x: hidden;
        user-select: none;
    }

    header input[type=text]{
        border-radius: 20px;
        padding: 0.5rem;
    }

    .low-high{
        display: flex;
        justify-content: center;
        gap: 1rem;
    }

    .degree-toggle{
        --width: 3.5rem;
        --height: 2rem;
        --inner: calc(var(--height)/1.3);
        --innersides: calc((var(--height) - var(--inner)) / 2);
        --border-radius: 50px
    }

    .degree-input{
        display: none;
    }

    .degree-slider{
        position: relative;
        width: var(--width);
        height: var(--height);
        border-radius: var(--border-radius);
        outline: 2px solid black;
        background-color: white;
        color:black;
        text-shadow: none;
    }

    .degree-slider::after{
        content: "";
        position: absolute;
        width: var(--inner);
        height: var(--inner);
        left: var(--innersides);
        top: var(--innersides);
        border-radius: var(--border-radius);
        background-color: black;
        transition: transform 0.2s;
    }

    .degree-input:checked ~ 
    .degree-slider::after{
        transform: translateX(calc(var(--width) - calc(var(--innersides)*2) - var(--inner)));
    }



    .input-c,.input-f{
        position: absolute;
        font-size: calc(var(--inner) - 0.2rem);
        top: calc(var(--innersides) - 0.1rem);
        transition: opacity 0.1s ease-in;
    }

    .input-f{
        right: calc(var(--innersides) + 0.1rem);
    }

    .input-c{
        opacity: 0;
        left: calc(var(--innersides) + 0.1rem);
    }

    .degree-input:checked ~.degree-slider .input-c{
        opacity: 1;
    }

    .degree-input:checked ~.degree-slider .input-f{
        opacity: 0;
    }

    img{
        width: 20ch;
    }

    .search-container{
        position: relative;
    }

    .error-msg{
        display: none;
        position: absolute;
        top: 0;
        right:100%;
        margin-right: 0.5rem;
        padding: 0.5rem;
        background-color: rgba(255, 0, 0, 0.7);
        border-radius: 20px;
        text-align: center;
        width: 20ch;
    }
</style>
</html>